{"version":3,"sources":["webpack://SolanaProvider/webpack/bootstrap","webpack://SolanaProvider/external \"eth-rpc-errors\"","webpack://SolanaProvider/external \"bs58\"","webpack://SolanaProvider/external \"@toruslabs/openlogin-jrpc\"","webpack://SolanaProvider/external \"@babel/runtime/helpers/defineProperty\"","webpack://SolanaProvider/external \"@solana/web3.js\"","webpack://SolanaProvider/external \"@web3auth/base\"","webpack://SolanaProvider/external \"@toruslabs/base-controllers\"","webpack://SolanaProvider/external \"@web3auth/base-provider\"","webpack://SolanaProvider/external \"@toruslabs/tweetnacl-js\"","webpack://SolanaProvider/./src/PrivateKeyWallet.ts","webpack://SolanaProvider/./src/rpc/JrpcClient.ts","webpack://SolanaProvider/./src/rpc/solanaRpcMiddlewares.ts","webpack://SolanaProvider/./src/providers/injectedProviders/injectedProviderProxy.ts","webpack://SolanaProvider/./src/providers/injectedProviders/phantom/providerHandlers.ts","webpack://SolanaProvider/./src/providers/injectedProviders/phantom/phantomInjectedProvider.ts","webpack://SolanaProvider/./src/providers/injectedProviders/torus/providerHandlers.ts","webpack://SolanaProvider/./src/providers/injectedProviders/torus/torusInjectedProvider.ts","webpack://SolanaProvider/./src/providers/injectedProviders/index.ts","webpack://SolanaProvider/./src/providers/privateKeyProvider/solanaPrivateKeyUtils.ts","webpack://SolanaProvider/./src/providers/privateKeyProvider/solanaPrivateKeyProvider.ts","webpack://SolanaProvider/./src/providers/index.ts","webpack://SolanaProvider/./src/solanaWallet.ts","webpack://SolanaProvider/./src/index.ts"],"names":["PrivateKeyWallet","constructor","provider","requestAccounts","accounts","request","method","params","signAndSendTransaction","transaction","signedTx","signTransaction","sig","bs58","encode","serialize","signature","sendTransaction","privateKey","keyPair","Keypair","fromSecretKey","Buffer","from","partialSign","signAllTransactions","transactions","map","signMessage","data","nacl","sign","detached","secretKey","args","result","createChainIdMiddleware","chainId","req","res","next","end","createProviderConfigMiddleware","providerConfig","createConfigMiddleware","configMiddleware","mergeMiddleware","createJsonRpcClient","rpcTarget","fetchMiddleware","createFetchMiddleware","networkMiddleware","createGetAccountsMiddleware","getAccounts","createAsyncMiddleware","response","Error","undefined","createRequestAccountsMiddleware","createGenericJRPCMiddleware","targetMethod","handler","createSolanaMiddleware","providerHandlers","getPrivateKey","getSecretKey","createChainSwitchMiddleware","addNewChainConfig","switchSolanaChain","createAccountMiddleware","updatePrivatekey","createInjectedProviderProxyMiddleware","_next","getPhantomHandlers","injectedProvider","publicKey","toBytes","ethErrors","rpc","methodNotSupported","message","decode","txn","Transaction","txRes","length","invalidParams","txns","msg","decodedMsg","PhantomInjectedProvider","BaseProvider","config","state","chainConfig","chainNamespace","CHAIN_NAMESPACES","SOLANA","switchChain","_","Promise","resolve","setupProvider","solanaMiddleware","injectedProviderProxy","engine","JRPCEngine","push","providerFromEngine","updateProviderEngineProxy","lookupNetwork","update","getTorusHandlers","toString","buf","sendTx","messages","TorusInjectedProvider","handleInjectedProviderUpdate","setupEngine","custom","code","connectedChainId","connectedHexChainId","isHexStrict","parseInt","WalletInitializationError","rpcConnectionError","emit","on","configure","getProviderHandlers","privKey","getProviderEngineProxy","transactionGenerator","serializedTx","decodedTx","tx","keyPairGenerator","toBase58","signedMsg","_providerEngineProxy","signedTransactions","SolanaPrivateKeyProvider","enable","bind","getChainSwitchMiddleware","getAccountMiddleware","updateAccount","existingKey","getChainConfig","health","chainSwitchHandlers","chainName","rpcUrls","blockExplorerUrls","nativeCurrency","addChain","ticker","symbol","tickerName","name","displayName","blockExplorer","chainSwitchMiddleware","accountHandlers","providerFactory","SolanaWallet","requireAllSignatures","signedTransaction"],"mappings":"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","file":"solanaProvider.cjs.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","module.exports = require(\"eth-rpc-errors\");","module.exports = require(\"bs58\");","module.exports = require(\"@toruslabs/openlogin-jrpc\");","module.exports = require(\"@babel/runtime/helpers/defineProperty\");","module.exports = require(\"@solana/web3.js\");","module.exports = require(\"@web3auth/base\");","module.exports = require(\"@toruslabs/base-controllers\");","module.exports = require(\"@web3auth/base-provider\");","module.exports = require(\"@toruslabs/tweetnacl-js\");","import { Keypair, Transaction } from \"@solana/web3.js\";\nimport nacl from \"@toruslabs/tweetnacl-js\";\nimport { RequestArguments, SafeEventEmitterProvider } from \"@web3auth/base\";\nimport bs58 from \"bs58\";\n\nimport { ISolanaWallet } from \"./interface\";\n\nexport class PrivateKeyWallet implements ISolanaWallet {\n  public provider: SafeEventEmitterProvider;\n\n  constructor(provider: SafeEventEmitterProvider) {\n    this.provider = provider;\n  }\n\n  public async requestAccounts(): Promise<string[]> {\n    const accounts = await this.provider.request<string[]>({\n      method: \"requestAccounts\",\n      params: {},\n    });\n    return accounts;\n  }\n\n  public async signAndSendTransaction(transaction: Transaction): Promise<{ signature: string }> {\n    const signedTx = await this.signTransaction(transaction);\n\n    const sig = await this.provider.request<string>({\n      method: \"sendTransaction\",\n      params: [bs58.encode(signedTx.serialize())],\n    });\n    return { signature: sig };\n  }\n\n  public async sendTransaction(transaction: Transaction): Promise<{ signature: string }> {\n    const signedTx = await this.signTransaction(transaction);\n\n    const sig = await this.provider.request<string>({\n      method: \"sendTransaction\",\n      params: [bs58.encode(signedTx.serialize())],\n    });\n    return { signature: sig };\n  }\n\n  public async signTransaction(transaction: Transaction): Promise<Transaction> {\n    const privateKey = await this.provider.request<string>({ method: \"solanaPrivateKey\" });\n    const keyPair = Keypair.fromSecretKey(Buffer.from(privateKey, \"hex\"));\n    transaction.partialSign(keyPair);\n    return transaction;\n  }\n\n  public async signAllTransactions(transactions: Transaction[]): Promise<Transaction[]> {\n    const privateKey = await this.provider.request<string>({ method: \"solanaPrivateKey\" });\n    const keyPair = Keypair.fromSecretKey(Buffer.from(privateKey, \"hex\"));\n\n    return transactions.map((transaction) => {\n      transaction.partialSign(keyPair);\n      return transaction;\n    });\n  }\n\n  public async signMessage(data: Uint8Array): Promise<Uint8Array> {\n    const privateKey = await this.provider.request<string>({ method: \"solanaPrivateKey\" });\n    const keyPair = Keypair.fromSecretKey(Buffer.from(privateKey, \"hex\"));\n    const signature = nacl.sign.detached(data, keyPair.secretKey);\n    return signature;\n  }\n\n  public async request<T>(args: RequestArguments): Promise<T> {\n    const result = await this.provider.request<T>(args);\n    return result as T;\n  }\n}\n","import { createFetchMiddleware } from \"@toruslabs/base-controllers\";\nimport { JRPCEngineEndCallback, JRPCEngineNextCallback, JRPCMiddleware, JRPCRequest, JRPCResponse, mergeMiddleware } from \"@toruslabs/openlogin-jrpc\";\nimport { CustomChainConfig } from \"@web3auth/base\";\n\nexport function createChainIdMiddleware(chainId: string): JRPCMiddleware<unknown, unknown> {\n  return (req: JRPCRequest<unknown>, res: JRPCResponse<string>, next: JRPCEngineNextCallback, end: JRPCEngineEndCallback) => {\n    if (req.method === \"solana_chainId\") {\n      res.result = chainId;\n      return end();\n    }\n    return next();\n  };\n}\n\nexport function createProviderConfigMiddleware(providerConfig: Omit<CustomChainConfig, \"chainNamespace\">): JRPCMiddleware<unknown, unknown> {\n  return (\n    req: JRPCRequest<unknown>,\n    res: JRPCResponse<Omit<CustomChainConfig, \"chainNamespace\">>,\n    next: JRPCEngineNextCallback,\n    end: JRPCEngineEndCallback\n  ) => {\n    if (req.method === \"solana_provider_config\") {\n      res.result = providerConfig;\n      return end();\n    }\n    return next();\n  };\n}\n\nexport function createConfigMiddleware(providerConfig: Omit<CustomChainConfig, \"chainNamespace\">): JRPCMiddleware<unknown, unknown> {\n  const { chainId } = providerConfig;\n  const configMiddleware = mergeMiddleware([createChainIdMiddleware(chainId), createProviderConfigMiddleware(providerConfig)]);\n  return configMiddleware;\n}\n\nexport function createJsonRpcClient(providerConfig: Omit<CustomChainConfig, \"chainNamespace\">): {\n  networkMiddleware: JRPCMiddleware<unknown, unknown>;\n  fetchMiddleware: JRPCMiddleware<unknown, unknown>;\n} {\n  const { rpcTarget } = providerConfig;\n  const fetchMiddleware = createFetchMiddleware({ rpcTarget });\n  const networkMiddleware = mergeMiddleware([createConfigMiddleware(providerConfig), fetchMiddleware]);\n  return { networkMiddleware, fetchMiddleware };\n}\n","import type { Transaction } from \"@solana/web3.js\";\nimport { createAsyncMiddleware, JRPCMiddleware, JRPCRequest, mergeMiddleware } from \"@toruslabs/openlogin-jrpc\";\n\nexport interface IProviderHandlers {\n  requestAccounts: (req: JRPCRequest<unknown>) => Promise<string[]>;\n  getAccounts: (req: JRPCRequest<unknown>) => Promise<string[]>;\n  getPrivateKey: (req: JRPCRequest<unknown>) => Promise<string>;\n  getSecretKey: (req: JRPCRequest<unknown>) => Promise<string>;\n  signTransaction: (req: JRPCRequest<{ message: string }>) => Promise<Transaction>;\n  signAllTransactions: (req: JRPCRequest<{ message: string[] }>) => Promise<Transaction[]>;\n  signAndSendTransaction: (req: JRPCRequest<{ message: string }>) => Promise<{ signature: string }>;\n  signMessage: (req: JRPCRequest<{ message: Uint8Array }>) => Promise<Uint8Array>;\n}\n\nexport function createGetAccountsMiddleware({ getAccounts }: { getAccounts: IProviderHandlers[\"getAccounts\"] }): JRPCMiddleware<unknown, unknown> {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const { method } = request;\n    if (method !== \"getAccounts\") return next();\n\n    if (!getAccounts) throw new Error(\"WalletMiddleware - opts.getAccounts not provided\");\n    // This calls from the prefs controller\n    const accounts = await getAccounts(request);\n    response.result = accounts;\n    return undefined;\n  });\n}\n\nexport function createRequestAccountsMiddleware({\n  requestAccounts,\n}: {\n  requestAccounts: IProviderHandlers[\"requestAccounts\"];\n}): JRPCMiddleware<unknown, unknown> {\n  return createAsyncMiddleware(async (request, response, next) => {\n    const { method } = request;\n    if (method !== \"requestAccounts\") return next();\n\n    if (!requestAccounts) throw new Error(\"WalletMiddleware - opts.requestAccounts not provided\");\n    // This calls the UI login function\n    const accounts = await requestAccounts(request);\n    response.result = accounts;\n    return undefined;\n  });\n}\n\nexport function createGenericJRPCMiddleware<T, U>(\n  targetMethod: string,\n  handler: (req: JRPCRequest<T>) => Promise<U>\n): JRPCMiddleware<unknown, unknown> {\n  return createAsyncMiddleware<T, unknown>(async (request, response, next) => {\n    const { method } = request;\n    if (method !== targetMethod) return next();\n\n    if (!handler) throw new Error(`WalletMiddleware - ${targetMethod} not provided`);\n\n    const result = await handler(request);\n\n    response.result = result;\n    return undefined;\n  });\n}\n\nexport function createSolanaMiddleware(providerHandlers: IProviderHandlers): JRPCMiddleware<unknown, unknown> {\n  const { getAccounts, requestAccounts, signTransaction, signAndSendTransaction, signAllTransactions, signMessage, getPrivateKey, getSecretKey } =\n    providerHandlers;\n\n  return mergeMiddleware([\n    createRequestAccountsMiddleware({ requestAccounts }),\n    createGetAccountsMiddleware({ getAccounts }),\n    createGenericJRPCMiddleware<{ message: string }, Transaction>(\"signTransaction\", signTransaction),\n    createGenericJRPCMiddleware<{ message: string }, { signature: string }>(\"signAndSendTransaction\", signAndSendTransaction),\n    createGenericJRPCMiddleware<{ message: string[] }, Transaction[]>(\"signAllTransactions\", signAllTransactions),\n    createGenericJRPCMiddleware<{ message: Uint8Array }, Uint8Array>(\"signMessage\", signMessage),\n    createGenericJRPCMiddleware<void, string>(\"solanaPrivateKey\", getPrivateKey),\n    createGenericJRPCMiddleware<void, string>(\"solanaSecretKey\", getSecretKey),\n  ]);\n}\nexport interface AddSolanaChainParameter {\n  chainId: string; // A 0x-prefixed hexadecimal string\n  chainName: string;\n  nativeCurrency: {\n    name: string;\n    symbol: string; // 2-6 characters long\n    decimals: 18;\n  };\n  rpcUrls: string[];\n  blockExplorerUrls?: string[];\n}\n\nexport interface IChainSwitchHandlers {\n  addNewChainConfig: (req: JRPCRequest<AddSolanaChainParameter>) => Promise<void>;\n  switchSolanaChain: (req: JRPCRequest<{ chainId: string }>) => Promise<void>;\n}\nexport function createChainSwitchMiddleware({ addNewChainConfig, switchSolanaChain }: IChainSwitchHandlers): JRPCMiddleware<unknown, unknown> {\n  return mergeMiddleware([\n    createGenericJRPCMiddleware<AddSolanaChainParameter, void>(\"addSolanaChain\", addNewChainConfig),\n    createGenericJRPCMiddleware<{ chainId: string }, void>(\"switchSolanaChain\", switchSolanaChain),\n  ]);\n}\n\nexport interface IAccountHandlers {\n  updatePrivatekey: (req: JRPCRequest<{ privateKey: string }>) => Promise<void>;\n}\nexport function createAccountMiddleware({ updatePrivatekey }: IAccountHandlers): JRPCMiddleware<unknown, unknown> {\n  return mergeMiddleware([createGenericJRPCMiddleware<{ privateKey: string }, void>(\"updateAccount\", updatePrivatekey)]);\n}\n","import { createAsyncMiddleware, JRPCEngineNextCallback, JRPCMiddleware, JRPCRequest, JRPCResponse } from \"@toruslabs/openlogin-jrpc\";\n\nimport { InjectedProvider } from \"./interface\";\n\nexport function createInjectedProviderProxyMiddleware(provider: InjectedProvider): JRPCMiddleware<unknown, unknown> {\n  return createAsyncMiddleware(async (req: JRPCRequest<unknown[]>, res: JRPCResponse<unknown>, _next: JRPCEngineNextCallback) => {\n    const result = await provider.request({\n      ...req,\n    });\n    res.result = result;\n  });\n}\n","import { Transaction } from \"@solana/web3.js\";\nimport { JRPCRequest } from \"@toruslabs/openlogin-jrpc\";\nimport bs58 from \"bs58\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { IPhantomWalletProvider } from \"../../../interface\";\nimport { IProviderHandlers } from \"../../../rpc/solanaRpcMiddlewares\";\n\nexport const getPhantomHandlers = (injectedProvider: IPhantomWalletProvider): IProviderHandlers => {\n  const providerHandlers: IProviderHandlers = {\n    requestAccounts: async () => {\n      return injectedProvider.publicKey ? [bs58.encode(injectedProvider.publicKey.toBytes())] : [];\n    },\n    getAccounts: async () => (injectedProvider.publicKey ? [bs58.encode(injectedProvider.publicKey.toBytes())] : []),\n    getPrivateKey: async () => {\n      throw ethErrors.rpc.methodNotSupported();\n    },\n    getSecretKey: async () => {\n      throw ethErrors.rpc.methodNotSupported();\n    },\n    signTransaction: async (req: JRPCRequest<{ message: string }>): Promise<Transaction> => {\n      const message = bs58.decode(req.params.message);\n      const txn = Transaction.from(message);\n      const transaction = await injectedProvider.signTransaction(txn);\n      return transaction;\n    },\n    signMessage: async (req: JRPCRequest<{ message: Uint8Array }>): Promise<Uint8Array> => {\n      const message = await injectedProvider.request<Uint8Array>({\n        method: \"signMessage\",\n        params: {\n          message: req.params?.message,\n        },\n      });\n      return message;\n    },\n    signAndSendTransaction: async (req: JRPCRequest<{ message: string }>): Promise<{ signature: string }> => {\n      const message = bs58.decode(req.params.message);\n      const txn = Transaction.from(message);\n      const txRes = await injectedProvider.signAndSendTransaction(txn);\n      return { signature: txRes.signature };\n    },\n    signAllTransactions: async (req: JRPCRequest<{ message: string[] }>): Promise<Transaction[]> => {\n      if (!req.params?.message || !req.params?.message.length) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const txns = req.params.message.map((msg) => {\n        const decodedMsg = bs58.decode(msg);\n        return Transaction.from(decodedMsg);\n      });\n      const transaction = await injectedProvider.signAllTransactions(txns);\n      return transaction;\n    },\n  };\n  return providerHandlers;\n};\n","import { providerFromEngine } from \"@toruslabs/base-controllers\";\nimport { JRPCEngine } from \"@toruslabs/openlogin-jrpc\";\nimport { CHAIN_NAMESPACES, CustomChainConfig } from \"@web3auth/base\";\nimport { BaseProvider, BaseProviderConfig, BaseProviderState } from \"@web3auth/base-provider\";\n\nimport { IPhantomWalletProvider } from \"../../../interface\";\nimport { createConfigMiddleware } from \"../../../rpc/JrpcClient\";\nimport { createSolanaMiddleware } from \"../../../rpc/solanaRpcMiddlewares\";\nimport { createInjectedProviderProxyMiddleware } from \"../injectedProviderProxy\";\nimport { getPhantomHandlers } from \"./providerHandlers\";\n\nexport class PhantomInjectedProvider extends BaseProvider<BaseProviderConfig, BaseProviderState, IPhantomWalletProvider> {\n  constructor({ config, state }: { config: BaseProviderConfig; state?: BaseProviderState }) {\n    super({ config: { chainConfig: { ...config.chainConfig, chainNamespace: CHAIN_NAMESPACES.SOLANA } }, state });\n  }\n\n  public async switchChain(_: { chainId: string }): Promise<void> {\n    return Promise.resolve();\n  }\n\n  public async setupProvider(injectedProvider: IPhantomWalletProvider): Promise<void> {\n    const providerHandlers = getPhantomHandlers(injectedProvider);\n    const solanaMiddleware = createSolanaMiddleware(providerHandlers);\n    const configMiddleware = createConfigMiddleware(this.config.chainConfig as CustomChainConfig);\n    const injectedProviderProxy = createInjectedProviderProxyMiddleware(injectedProvider);\n    const engine = new JRPCEngine();\n    engine.push(solanaMiddleware);\n    engine.push(configMiddleware);\n    engine.push(injectedProviderProxy);\n    const provider = providerFromEngine(engine);\n\n    this.updateProviderEngineProxy(provider);\n    await this.lookupNetwork(injectedProvider);\n  }\n\n  protected async lookupNetwork(_: IPhantomWalletProvider): Promise<string> {\n    const { chainConfig } = this.config;\n    this.update({\n      chainId: chainConfig.chainId,\n    });\n    return chainConfig.chainId || \"\";\n    // const genesisHash = await phantomProvider.request<string>({\n    //   method: \"getGenesisHash\",\n    //   params: [],\n    // });\n    // const { chainConfig } = this.config;\n    // if (!genesisHash) throw WalletInitializationError.rpcConnectionError(`Failed to connect with phantom wallet`);\n    // if (chainConfig.chainId !== genesisHash.substring(0, 32))\n    //   throw WalletInitializationError.invalidNetwork(\n    //     `Wallet is connected to wrong network,Please change your network to ${\n    //       SOLANA_NETWORKS[chainConfig.chainId] || chainConfig.displayName\n    //     } from phantom wallet extention.`\n    //   );\n    // return genesisHash.substring(0, 32);\n  }\n}\n","import { Transaction } from \"@solana/web3.js\";\nimport { JRPCRequest } from \"@toruslabs/openlogin-jrpc\";\nimport bs58 from \"bs58\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { IProviderHandlers } from \"../../../rpc/solanaRpcMiddlewares\";\nimport { InjectedProvider } from \"../interface\";\n\nexport const getTorusHandlers = (injectedProvider: InjectedProvider): IProviderHandlers => {\n  const providerHandlers: IProviderHandlers = {\n    requestAccounts: async () => {\n      const accounts = await injectedProvider.request<string[]>({\n        method: \"solana_requestAccounts\",\n        params: {},\n      });\n      return accounts;\n    },\n\n    getAccounts: async () => {\n      const accounts = await injectedProvider.request<string[]>({\n        method: \"solana_accounts\",\n        params: {},\n      });\n      return accounts;\n    },\n\n    getPrivateKey: async () => {\n      throw ethErrors.rpc.methodNotSupported();\n    },\n    getSecretKey: async () => {\n      throw ethErrors.rpc.methodNotSupported();\n    },\n    signMessage: async (req: JRPCRequest<{ message: Uint8Array }>): Promise<Uint8Array> => {\n      const message = await injectedProvider.request<Uint8Array>({\n        method: \"sign_message\",\n        params: {\n          data: req.params?.message,\n        },\n      });\n      return message;\n    },\n\n    signTransaction: async (req: JRPCRequest<{ message: string }>): Promise<Transaction> => {\n      if (!req.params?.message) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const message = bs58.decode(req.params.message).toString(\"hex\");\n      const response = await injectedProvider.request<string>({\n        method: \"sign_transaction\",\n        params: { message },\n      });\n\n      const buf = Buffer.from(response, \"hex\");\n      const sendTx = Transaction.from(buf);\n      return sendTx;\n    },\n\n    signAndSendTransaction: async (req: JRPCRequest<{ message: string }>): Promise<{ signature: string }> => {\n      if (!req.params?.message) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const message = bs58.decode(req.params.message).toString(\"hex\");\n\n      const response = await injectedProvider.request<string>({\n        method: \"send_transaction\",\n        params: { message },\n      });\n      return { signature: response };\n    },\n\n    signAllTransactions: async (req: JRPCRequest<{ message: string[] }>): Promise<Transaction[]> => {\n      if (!req.params?.message || !req.params?.message.length) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const messages: string[] = [];\n      for (const transaction of req.params.message) {\n        const message = bs58.decode(transaction).toString(\"hex\");\n        messages.push(message);\n      }\n      const response = await injectedProvider.request<Transaction[]>({\n        method: \"sign_all_transactions\",\n        params: { message: messages },\n      });\n      return response;\n    },\n  };\n  return providerHandlers;\n};\n","import { providerFromEngine } from \"@toruslabs/base-controllers\";\nimport { JRPCEngine } from \"@toruslabs/openlogin-jrpc\";\nimport { CHAIN_NAMESPACES, isHexStrict, WalletInitializationError } from \"@web3auth/base\";\nimport { BaseProvider, BaseProviderConfig, BaseProviderState } from \"@web3auth/base-provider\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { createSolanaMiddleware } from \"../../../rpc/solanaRpcMiddlewares\";\nimport { createInjectedProviderProxyMiddleware } from \"../injectedProviderProxy\";\nimport { InjectedProvider } from \"../interface\";\nimport { getTorusHandlers } from \"./providerHandlers\";\n\nexport class TorusInjectedProvider extends BaseProvider<BaseProviderConfig, BaseProviderState, InjectedProvider> {\n  constructor({ config, state }: { config: BaseProviderConfig; state?: BaseProviderState }) {\n    super({ config: { chainConfig: { ...config.chainConfig, chainNamespace: CHAIN_NAMESPACES.SOLANA } }, state });\n  }\n\n  public async switchChain(_: { chainId: string }): Promise<void> {\n    return Promise.resolve();\n  }\n\n  public async setupProvider(injectedProvider: InjectedProvider): Promise<void> {\n    this.handleInjectedProviderUpdate(injectedProvider);\n    await this.setupEngine(injectedProvider);\n  }\n\n  protected async lookupNetwork(): Promise<string> {\n    if (!this.provider) throw ethErrors.provider.custom({ message: \"Torus solana provider is not initialized\", code: 4902 });\n    const { chainId } = this.config.chainConfig;\n\n    const connectedChainId = await this.provider.request<unknown, string>({\n      method: \"solana_chainId\",\n    });\n\n    const connectedHexChainId = isHexStrict(connectedChainId.toString()) ? connectedChainId : `0x${parseInt(connectedChainId, 10).toString(16)}`;\n    if (chainId !== connectedHexChainId)\n      throw WalletInitializationError.rpcConnectionError(`Invalid network, net_version is: ${connectedHexChainId}, expected: ${chainId}`);\n\n    this.update({ chainId: connectedHexChainId });\n    this.provider.emit(\"connect\", { chainId: this.state.chainId });\n    this.provider.emit(\"chainChanged\", this.state.chainId);\n    return this.state.chainId;\n  }\n\n  private async setupEngine(injectedProvider: InjectedProvider): Promise<void> {\n    const providerHandlers = getTorusHandlers(injectedProvider);\n    const solanaMiddleware = createSolanaMiddleware(providerHandlers);\n    const injectedProviderProxy = createInjectedProviderProxyMiddleware(injectedProvider);\n    const engine = new JRPCEngine();\n    engine.push(solanaMiddleware);\n    engine.push(injectedProviderProxy);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n    await this.lookupNetwork();\n  }\n\n  private async handleInjectedProviderUpdate(injectedProvider: InjectedProvider): Promise<void> {\n    injectedProvider.on(\"accountsChanged\", async (accounts: string[]) => {\n      this.provider.emit(\"accountsChanged\", accounts);\n    });\n    injectedProvider.on(\"chainChanged\", async (chainId: string) => {\n      const connectedHexChainId = isHexStrict(chainId) ? chainId : `0x${parseInt(chainId, 10).toString(16)}`;\n      // Check if chainId changed and trigger event\n      this.configure({\n        chainConfig: { ...this.config.chainConfig, chainId: connectedHexChainId },\n      });\n      await this.setupProvider(injectedProvider);\n    });\n  }\n}\n","export * from \"./interface\";\nexport * from \"./phantom/phantomInjectedProvider\";\nexport * from \"./torus/torusInjectedProvider\";\n","import { Keypair, Transaction } from \"@solana/web3.js\";\nimport { JRPCRequest } from \"@toruslabs/openlogin-jrpc\";\nimport nacl from \"@toruslabs/tweetnacl-js\";\nimport { SafeEventEmitterProvider, WalletInitializationError } from \"@web3auth/base\";\nimport bs58 from \"bs58\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { IProviderHandlers } from \"../../rpc/solanaRpcMiddlewares\";\n\nexport async function getProviderHandlers({\n  privKey,\n  getProviderEngineProxy,\n}: {\n  privKey: string;\n  getProviderEngineProxy: () => SafeEventEmitterProvider | null;\n}): Promise<IProviderHandlers> {\n  const transactionGenerator = (serializedTx: string): Transaction => {\n    const decodedTx = bs58.decode(serializedTx);\n    const tx = Transaction.from(decodedTx);\n    return tx;\n  };\n  const keyPairGenerator = (): Keypair => {\n    return Keypair.fromSecretKey(Buffer.from(privKey, \"hex\"));\n  };\n  if (typeof privKey !== \"string\") throw WalletInitializationError.invalidParams(\"privKey must be a string\");\n  const keyPair = keyPairGenerator();\n  const providerHandlers: IProviderHandlers = {\n    requestAccounts: async () => {\n      return [keyPair.publicKey.toBase58()];\n    },\n    getAccounts: async () => [keyPair.publicKey.toBase58()],\n\n    getPrivateKey: async () => privKey,\n\n    getSecretKey: async () => bs58.encode(keyPair.secretKey),\n\n    signTransaction: async (req: JRPCRequest<{ message: string }>): Promise<Transaction> => {\n      if (!req.params?.message) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const transaction = transactionGenerator(req.params?.message as string);\n      transaction.partialSign(keyPair);\n      return transaction;\n    },\n\n    signMessage: async (req: JRPCRequest<{ message: Uint8Array }>): Promise<Uint8Array> => {\n      if (!req.params?.message) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const signedMsg = nacl.sign.detached(req.params.message, keyPair.secretKey);\n      return signedMsg;\n    },\n\n    signAndSendTransaction: async (req: JRPCRequest<{ message: string }>): Promise<{ signature: string }> => {\n      if (!req.params?.message) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const _providerEngineProxy = getProviderEngineProxy();\n      if (!_providerEngineProxy) throw ethErrors.provider.custom({ message: \"Provider is not initialized\", code: 4902 });\n\n      const transaction = transactionGenerator(req.params?.message as string);\n      transaction.sign(keyPair);\n\n      const sig = await _providerEngineProxy.request<string>({\n        method: \"sendTransaction\",\n        params: [bs58.encode(transaction.serialize())],\n      });\n      return { signature: sig };\n    },\n\n    signAllTransactions: async (req: JRPCRequest<{ message: string[] }>): Promise<Transaction[]> => {\n      if (!req.params?.message || !req.params?.message.length) {\n        throw ethErrors.rpc.invalidParams(\"message\");\n      }\n      const signedTransactions: Transaction[] = [];\n      for (const tx of req.params?.message || []) {\n        const transaction = transactionGenerator(tx);\n        transaction.partialSign(keyPair);\n        signedTransactions.push(transaction);\n      }\n      return signedTransactions;\n    },\n  };\n\n  return providerHandlers;\n}\n","import { providerFromEngine } from \"@toruslabs/base-controllers\";\nimport { JRPCEngine, JRPCMiddleware, JRPCRequest } from \"@toruslabs/openlogin-jrpc\";\nimport { CHAIN_NAMESPACES, CustomChainConfig, WalletInitializationError } from \"@web3auth/base\";\nimport { BaseProvider, BaseProviderConfig, BaseProviderState } from \"@web3auth/base-provider\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { createJsonRpcClient } from \"../../rpc/JrpcClient\";\nimport {\n  AddSolanaChainParameter,\n  createAccountMiddleware,\n  createChainSwitchMiddleware,\n  createSolanaMiddleware,\n  IAccountHandlers,\n  IChainSwitchHandlers,\n} from \"../../rpc/solanaRpcMiddlewares\";\nimport { getProviderHandlers } from \"./solanaPrivateKeyUtils\";\n\nexport interface SolanaPrivKeyProviderConfig extends BaseProviderConfig {\n  chainConfig: Omit<CustomChainConfig, \"chainNamespace\">;\n}\nexport interface SolanaPrivKeyProviderState extends BaseProviderState {\n  privateKey?: string;\n}\nexport class SolanaPrivateKeyProvider extends BaseProvider<BaseProviderConfig, SolanaPrivKeyProviderState, string> {\n  constructor({ config, state }: { config: SolanaPrivKeyProviderConfig; state?: BaseProviderState }) {\n    super({ config: { chainConfig: { ...config.chainConfig, chainNamespace: CHAIN_NAMESPACES.SOLANA } }, state });\n  }\n\n  public static getProviderInstance = async (params: {\n    privKey: string;\n    chainConfig: Omit<CustomChainConfig, \"chainNamespace\">;\n  }): Promise<SolanaPrivateKeyProvider> => {\n    const providerFactory = new SolanaPrivateKeyProvider({ config: { chainConfig: params.chainConfig } });\n    await providerFactory.setupProvider(params.privKey);\n    return providerFactory;\n  };\n\n  public async enable(): Promise<string[]> {\n    if (!this.state.privateKey)\n      throw ethErrors.provider.custom({ message: \"Private key is not found in state, plz pass it in constructor state param\", code: 4902 });\n    await this.setupProvider(this.state.privateKey);\n    return this._providerEngineProxy.request<unknown, string[]>({ method: \"eth_accounts\" });\n  }\n\n  public async setupProvider(privKey: string): Promise<void> {\n    const providerHandlers = await getProviderHandlers({ privKey, getProviderEngineProxy: this.getProviderEngineProxy.bind(this) });\n\n    const solanaMiddleware = createSolanaMiddleware(providerHandlers);\n\n    const engine = new JRPCEngine();\n    const { networkMiddleware } = createJsonRpcClient(this.config.chainConfig as CustomChainConfig);\n    engine.push(this.getChainSwitchMiddleware());\n    engine.push(this.getAccountMiddleware());\n    engine.push(solanaMiddleware);\n    engine.push(networkMiddleware);\n\n    const provider = providerFromEngine(engine);\n\n    this.updateProviderEngineProxy(provider);\n\n    await this.lookupNetwork();\n  }\n\n  public async updateAccount(params: { privateKey: string }): Promise<void> {\n    if (!this._providerEngineProxy) throw ethErrors.provider.custom({ message: \"Provider is not initialized\", code: 4902 });\n    const existingKey = await this._providerEngineProxy.request<unknown, string>({ method: \"solanaPrivateKey\" });\n    if (existingKey !== params.privateKey) {\n      await this.setupProvider(params.privateKey);\n      this._providerEngineProxy.emit(\"accountsChanged\", {\n        accounts: await this._providerEngineProxy.request<unknown, string[]>({ method: \"requestAccounts\" }),\n      });\n    }\n  }\n\n  public async switchChain(params: { chainId: string }): Promise<void> {\n    if (!this._providerEngineProxy) throw ethErrors.provider.custom({ message: \"Provider is not initialized\", code: 4902 });\n    const chainConfig = this.getChainConfig(params.chainId);\n    this.update({\n      chainId: \"loading\",\n    });\n    this.configure({ chainConfig });\n    const privKey = await this._providerEngineProxy.request<unknown, string>({ method: \"solanaPrivateKey\" });\n    await this.setupProvider(privKey);\n  }\n\n  protected async lookupNetwork(): Promise<string> {\n    if (!this._providerEngineProxy) throw ethErrors.provider.custom({ message: \"Provider is not initialized\", code: 4902 });\n    const health = await this._providerEngineProxy.request<unknown, string>({\n      method: \"getHealth\",\n      params: [],\n    });\n    const { chainConfig } = this.config;\n    if (health !== \"ok\")\n      throw WalletInitializationError.rpcConnectionError(`Failed to lookup network for following rpc target: ${chainConfig.rpcTarget}`);\n    this.update({ chainId: chainConfig.chainId });\n    if (this.state.chainId !== chainConfig.chainId) {\n      this.provider.emit(\"chainChanged\", this.state.chainId);\n      this.provider.emit(\"connect\", { chainId: this.state.chainId });\n    }\n    return this.state.chainId;\n  }\n\n  private getChainSwitchMiddleware(): JRPCMiddleware<unknown, unknown> {\n    const chainSwitchHandlers: IChainSwitchHandlers = {\n      addNewChainConfig: async (req: JRPCRequest<AddSolanaChainParameter>): Promise<void> => {\n        if (!req.params) throw ethErrors.rpc.invalidParams(\"Missing request params\");\n        const { chainId, chainName, rpcUrls, blockExplorerUrls, nativeCurrency } = req.params;\n\n        if (!chainId) throw ethErrors.rpc.invalidParams(\"Missing chainId in chainParams\");\n        if (!rpcUrls || rpcUrls.length === 0) throw ethErrors.rpc.invalidParams(\"Missing rpcUrls in chainParams\");\n        if (!nativeCurrency) throw ethErrors.rpc.invalidParams(\"Missing nativeCurrency in chainParams\");\n        this.addChain({\n          chainNamespace: CHAIN_NAMESPACES.SOLANA,\n          chainId,\n          ticker: nativeCurrency?.symbol || \"SOL\",\n          tickerName: nativeCurrency?.name || \"Solana\",\n          displayName: chainName,\n          rpcTarget: rpcUrls[0],\n          blockExplorer: blockExplorerUrls?.[0] || \"\",\n        });\n      },\n      switchSolanaChain: async (req: JRPCRequest<{ chainId: string }>): Promise<void> => {\n        if (!req.params) throw ethErrors.rpc.invalidParams(\"Missing request params\");\n        if (!req.params.chainId) throw ethErrors.rpc.invalidParams(\"Missing chainId\");\n        await this.switchChain(req.params);\n      },\n    };\n    const chainSwitchMiddleware = createChainSwitchMiddleware(chainSwitchHandlers);\n    return chainSwitchMiddleware;\n  }\n\n  private getAccountMiddleware(): JRPCMiddleware<unknown, unknown> {\n    const accountHandlers: IAccountHandlers = {\n      updatePrivatekey: async (req: JRPCRequest<{ privateKey: string }>): Promise<void> => {\n        if (!req.params) throw ethErrors.rpc.invalidParams(\"Missing request params\");\n        if (!req.params.privateKey) throw ethErrors.rpc.invalidParams(\"Missing privateKey\");\n        const { privateKey } = req.params;\n        await this.updateAccount({ privateKey });\n      },\n    };\n    return createAccountMiddleware(accountHandlers);\n  }\n}\n","export * from \"./injectedProviders\";\nexport * from \"./privateKeyProvider\";\n","import type { Transaction } from \"@solana/web3.js\";\nimport { RequestArguments, SafeEventEmitterProvider } from \"@web3auth/base\";\nimport bs58 from \"bs58\";\n\nimport { ISolanaWallet } from \"./interface\";\n\nexport class SolanaWallet implements ISolanaWallet {\n  public provider: SafeEventEmitterProvider;\n\n  constructor(provider: SafeEventEmitterProvider) {\n    this.provider = provider;\n  }\n\n  public async requestAccounts(): Promise<string[]> {\n    const accounts = await this.provider.request<string[]>({\n      method: \"requestAccounts\",\n      params: {},\n    });\n    return accounts;\n  }\n\n  public async signAndSendTransaction(transaction: Transaction): Promise<{ signature: string }> {\n    const { signature } = await this.provider.request<{ signature: string }>({\n      method: \"signAndSendTransaction\",\n      params: {\n        message: bs58.encode(transaction.serialize({ requireAllSignatures: false })),\n      },\n    });\n    return { signature };\n  }\n\n  public async signTransaction(transaction: Transaction): Promise<Transaction> {\n    const signedTransaction = (await this.provider.request({\n      method: \"signTransaction\",\n      params: {\n        message: bs58.encode(transaction.serialize({ requireAllSignatures: false })),\n      },\n    })) as Transaction;\n    return signedTransaction;\n  }\n\n  public async signAllTransactions(transactions: Transaction[]): Promise<Transaction[]> {\n    const messages = transactions.map((transaction) => {\n      return bs58.encode(transaction.serialize({ requireAllSignatures: false }));\n    });\n    const signedTransaction = (await this.provider.request({\n      method: \"signAllTransactions\",\n      params: {\n        message: messages,\n      },\n    })) as Transaction[];\n    return signedTransaction;\n  }\n\n  public async signMessage(data: Uint8Array): Promise<Uint8Array> {\n    const response = await this.provider.request<Uint8Array>({\n      method: \"signMessage\",\n      params: {\n        message: data,\n      },\n    });\n    return response as Uint8Array;\n  }\n\n  public async request<T>(args: RequestArguments): Promise<T> {\n    const result = await this.provider.request<T>(args);\n    return result as T;\n  }\n}\n","export * from \"./interface\";\nexport * from \"./PrivateKeyWallet\";\nexport * from \"./providers\";\nexport * from \"./solanaWallet\";\n"],"sourceRoot":""}